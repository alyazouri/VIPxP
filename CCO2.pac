ÿ©function FindProxyForURL(url, host) {
  var h = host.toLowerCase();
  var u = url.toLowerCase();

  // üéØ ÿ®ÿ±ŸàŸÉÿ≥Ÿäÿßÿ™ ÿ£ÿ±ÿØŸÜŸäÿ© ŸÖÿ™ÿÆÿµÿµÿ© ÿ≠ÿ≥ÿ® ÿßŸÑÿ£ŸàŸÑŸàŸäÿ©
  var PROXY_JO_PURE = "PROXY 46.185.131.218:20001";
  var PROXY_JO_PRIMARY = "PROXY 91.106.109.12:9030";
  var PROXY_JO_SECONDARY = "PROXY 176.29.153.95:20001";
  var BLOCK = "PROXY 127.0.0.1:1";
  var DIRECT_CONNECTION = "DIRECT";

  // üìç ÿßŸÑÿ£ŸàŸÑŸàŸäÿ© 1: üáØüá¥ ÿßŸÑÿ£ÿ±ÿØŸÜ - Hop ÿ£ÿ±ÿØŸÜŸä 1000%
  var JORDAN_PURE_IPV4 = [
    ["37.230.0.0", "255.254.0.0"],
    ["37.238.0.0", "255.254.0.0"],
    ["37.239.0.0", "255.255.0.0"],
    ["46.23.0.0", "255.255.0.0"],
    ["46.29.0.0", "255.255.0.0"],
    ["46.30.0.0", "255.254.0.0"],
    ["46.244.0.0", "255.252.0.0"],
    ["82.212.0.0", "255.255.0.0"],
    ["91.106.64.0", "255.255.192.0"],
    ["176.56.0.0", "255.248.0.0"],
    ["176.74.0.0", "255.254.0.0"],
    ["176.95.128.0", "255.255.192.0"],
    ["176.110.0.0", "255.254.0.0"],
    ["185.84.0.0", "255.252.0.0"],
    ["185.117.136.0", "255.255.248.0"],
    ["188.161.0.0", "255.255.0.0"],
    ["188.162.0.0", "255.255.0.0"],
    ["195.135.128.0", "255.255.192.0"],
    ["212.100.128.0", "255.255.128.0"],
    ["213.6.128.0", "255.255.128.0"]
  ];

  // üìç ÿßŸÑÿ£ŸàŸÑŸàŸäÿ© 2: üáµüá∏ ŸÅŸÑÿ≥ÿ∑ŸäŸÜ - Hop ÿ£ÿ±ÿØŸÜŸä 90%
  var PALESTINE_IPV4 = [
    ["185.85.0.0", "255.255.0.0"],
    ["188.163.0.0", "255.255.252.0"],
    ["185.178.0.0", "255.254.0.0"]
  ];

  // üìç ÿßŸÑÿ£ŸàŸÑŸàŸäÿ© 5: üá∏üá¶ ÿßŸÑÿ≥ÿπŸàÿØŸäÿ© ÿßŸÑÿ¥ŸÖÿßŸÑ - Hop ÿ£ÿ±ÿØŸÜŸä 80%
  var SAUDI_NORTH_IPV4 = [
    ["188.164.0.0", "255.255.252.0"],
    ["85.185.0.0", "255.255.0.0"]
  ];

  // üìç ÿßŸÑÿ£ŸàŸÑŸàŸäÿ© 6: üá∞üáº ÿßŸÑŸÉŸàŸäÿ™ - Hop ÿ£ÿ±ÿØŸÜŸä 40%
  var KUWAIT_IPV4 = [
    ["213.42.0.0", "255.254.0.0"],
    ["185.59.136.0", "255.255.248.0"]
  ];

  // üìç ÿßŸÑÿ£ŸàŸÑŸàŸäÿ© 3: üá∏üáæüá±üáß ÿßŸÑÿ¥ÿßŸÖ - Hop ÿ£ÿ±ÿØŸÜŸä 30%
  var LEVANT_IPV4 = [
    ["185.49.0.0", "255.255.0.0"],
    ["176.58.0.0", "255.254.0.0"]
  ];

  // üìç ÿßŸÑÿ£ŸàŸÑŸàŸäÿ© 4: üáÆüá∂ ÿßŸÑÿπÿ±ÿßŸÇ - Hop ÿ£ÿ±ÿØŸÜŸä 10%
  var IRAQ_IPV4 = [
    ["149.255.0.0", "255.255.0.0"],
    ["185.82.0.0", "255.254.0.0"],
    ["185.83.0.0", "255.255.0.0"]
  ];

  // ‚ùå ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿ≠ÿ∏ÿ± ÿßŸÑÿ¥ÿßŸÖŸÑÿ©
  var BLOCKED_REGIONS_IPV4 = [
    // ÿ£Ÿàÿ±Ÿàÿ®ÿß
    ["2.0.0.0", "255.0.0.0"],
    ["31.0.0.0", "255.0.0.0"],
    ["37.0.0.0", "255.128.0.0"],
    ["37.128.0.0", "255.192.0.0"],
    ["37.192.0.0", "255.224.0.0"],
    ["37.224.0.0", "255.248.0.0"],
    ["37.240.0.0", "255.240.0.0"],
    ["46.0.0.0", "255.224.0.0"],
    ["46.32.0.0", "255.224.0.0"],
    ["46.64.0.0", "255.192.0.0"],
    ["46.128.0.0", "255.128.0.0"],
    ["62.0.0.0", "255.0.0.0"],
    ["77.0.0.0", "255.0.0.0"],
    ["78.0.0.0", "255.0.0.0"],
    ["79.0.0.0", "255.0.0.0"],
    ["80.0.0.0", "255.0.0.0"],
    ["81.0.0.0", "255.0.0.0"],
    ["82.0.0.0", "255.128.0.0"],
    ["82.128.0.0", "255.192.0.0"],
    ["82.192.0.0", "255.240.0.0"],
    ["82.208.0.0", "255.248.0.0"],
    ["82.216.0.0", "255.248.0.0"],
    ["82.224.0.0", "255.224.0.0"],
    ["83.0.0.0", "255.0.0.0"],
    ["84.0.0.0", "255.0.0.0"],
    ["85.0.0.0", "255.128.0.0"],
    ["85.128.0.0", "255.192.0.0"],
    ["85.192.0.0", "255.192.0.0"],
    ["86.0.0.0", "255.0.0.0"],
    ["87.0.0.0", "255.0.0.0"],
    ["88.0.0.0", "255.0.0.0"],
    ["89.0.0.0", "255.0.0.0"],
    ["90.0.0.0", "255.0.0.0"],
    ["91.0.0.0", "255.128.0.0"],
    ["91.128.0.0", "255.128.0.0"],
    ["92.0.0.0", "255.0.0.0"],
    ["93.0.0.0", "255.0.0.0"],
    ["94.0.0.0", "255.0.0.0"],
    ["95.0.0.0", "255.0.0.0"],
    ["109.0.0.0", "255.0.0.0"],
    ["141.0.0.0", "255.0.0.0"],
    ["145.0.0.0", "255.0.0.0"],
    ["149.0.0.0", "255.128.0.0"],
    ["149.128.0.0", "255.128.0.0"],
    ["151.0.0.0", "255.0.0.0"],
    ["176.0.0.0", "255.192.0.0"],
    ["176.64.0.0", "255.224.0.0"],
    ["176.96.0.0", "255.224.0.0"],
    ["176.128.0.0", "255.128.0.0"],
    ["178.0.0.0", "255.0.0.0"],
    ["185.0.0.0", "255.192.0.0"],
    ["185.64.0.0", "255.224.0.0"],
    ["185.96.0.0", "255.224.0.0"],
    ["185.128.0.0", "255.192.0.0"],
    ["185.192.0.0", "255.192.0.0"],
    ["188.0.0.0", "255.128.0.0"],
    ["188.128.0.0", "255.224.0.0"],
    ["188.160.0.0", "255.248.0.0"],
    ["188.168.0.0", "255.248.0.0"],
    ["188.176.0.0", "255.240.0.0"],
    ["188.192.0.0", "255.192.0.0"],
    ["193.0.0.0", "255.0.0.0"],
    ["194.0.0.0", "255.0.0.0"],
    ["195.0.0.0", "255.128.0.0"],
    ["195.128.0.0", "255.192.0.0"],
    ["195.192.0.0", "255.192.0.0"],
    ["212.0.0.0", "255.128.0.0"],
    ["212.128.0.0", "255.128.0.0"],
    ["213.0.0.0", "255.248.0.0"],
    ["213.8.0.0", "255.248.0.0"],
    ["213.16.0.0", "255.240.0.0"],
    ["213.32.0.0", "255.224.0.0"],
    ["213.64.0.0", "255.192.0.0"],
    ["213.128.0.0", "255.192.0.0"],
    ["213.192.0.0", "255.192.0.0"],
    ["217.0.0.0", "255.0.0.0"],
    
    // ÿ¢ÿ≥Ÿäÿß
    ["1.0.0.0", "255.0.0.0"],
    ["14.0.0.0", "255.0.0.0"],
    ["27.0.0.0", "255.0.0.0"],
    ["36.0.0.0", "255.0.0.0"],
    ["39.0.0.0", "255.0.0.0"],
    ["42.0.0.0", "255.0.0.0"],
    ["43.0.0.0", "255.0.0.0"],
    ["49.0.0.0", "255.0.0.0"],
    ["58.0.0.0", "255.0.0.0"],
    ["59.0.0.0", "255.0.0.0"],
    ["60.0.0.0", "255.0.0.0"],
    ["61.0.0.0", "255.0.0.0"],
    ["101.0.0.0", "255.0.0.0"],
    ["103.0.0.0", "255.0.0.0"],
    ["106.0.0.0", "255.0.0.0"],
    ["110.0.0.0", "255.0.0.0"],
    ["111.0.0.0", "255.0.0.0"],
    ["112.0.0.0", "255.0.0.0"],
    ["113.0.0.0", "255.0.0.0"],
    ["114.0.0.0", "255.0.0.0"],
    ["115.0.0.0", "255.0.0.0"],
    ["116.0.0.0", "255.0.0.0"],
    ["117.0.0.0", "255.0.0.0"],
    ["118.0.0.0", "255.0.0.0"],
    ["119.0.0.0", "255.0.0.0"],
    ["120.0.0.0", "255.0.0.0"],
    ["121.0.0.0", "255.0.0.0"],
    ["122.0.0.0", "255.0.0.0"],
    ["123.0.0.0", "255.0.0.0"],
    ["124.0.0.0", "255.0.0.0"],
    ["125.0.0.0", "255.0.0.0"],
    ["175.0.0.0", "255.0.0.0"],
    ["180.0.0.0", "255.0.0.0"],
    ["182.0.0.0", "255.0.0.0"],
    ["183.0.0.0", "255.0.0.0"],
    ["202.0.0.0", "255.0.0.0"],
    ["203.0.0.0", "255.0.0.0"],
    ["210.0.0.0", "255.0.0.0"],
    ["211.0.0.0", "255.0.0.0"],
    ["218.0.0.0", "255.0.0.0"],
    ["219.0.0.0", "255.0.0.0"],
    ["220.0.0.0", "255.0.0.0"],
    ["221.0.0.0", "255.0.0.0"],
    ["222.0.0.0", "255.0.0.0"],
    ["223.0.0.0", "255.0.0.0"],
    
    // ÿ£ŸÅÿ±ŸäŸÇŸäÿß
    ["41.0.0.0", "255.0.0.0"],
    ["102.0.0.0", "255.0.0.0"],
    ["105.0.0.0", "255.0.0.0"],
    ["154.0.0.0", "255.0.0.0"],
    ["155.0.0.0", "255.0.0.0"],
    ["156.0.0.0", "255.0.0.0"],
    ["160.0.0.0", "255.0.0.0"],
    ["169.0.0.0", "255.0.0.0"],
    ["196.0.0.0", "255.0.0.0"],
    ["197.0.0.0", "255.0.0.0"],
    
    // ÿ£ŸÖÿ±ŸäŸÉÿß
    ["3.0.0.0", "255.0.0.0"],
    ["4.0.0.0", "255.0.0.0"],
    ["6.0.0.0", "255.0.0.0"],
    ["7.0.0.0", "255.0.0.0"],
    ["8.0.0.0", "255.0.0.0"],
    ["9.0.0.0", "255.0.0.0"],
    ["11.0.0.0", "255.0.0.0"],
    ["12.0.0.0", "255.0.0.0"],
    ["13.0.0.0", "255.0.0.0"],
    ["15.0.0.0", "255.0.0.0"],
    ["16.0.0.0", "255.0.0.0"],
    ["17.0.0.0", "255.0.0.0"],
    ["18.0.0.0", "255.0.0.0"],
    ["19.0.0.0", "255.0.0.0"],
    ["20.0.0.0", "255.0.0.0"],
    ["21.0.0.0", "255.0.0.0"],
    ["22.0.0.0", "255.0.0.0"],
    ["23.0.0.0", "255.0.0.0"],
    ["24.0.0.0", "255.0.0.0"],
    ["25.0.0.0", "255.0.0.0"],
    ["26.0.0.0", "255.0.0.0"],
    ["28.0.0.0", "255.0.0.0"],
    ["29.0.0.0", "255.0.0.0"],
    ["30.0.0.0", "255.0.0.0"],
    ["32.0.0.0", "255.0.0.0"],
    ["33.0.0.0", "255.0.0.0"],
    ["34.0.0.0", "255.0.0.0"],
    ["35.0.0.0", "255.0.0.0"],
    ["38.0.0.0", "255.0.0.0"],
    ["40.0.0.0", "255.0.0.0"],
    ["44.0.0.0", "255.0.0.0"],
    ["45.0.0.0", "255.0.0.0"],
    ["47.0.0.0", "255.0.0.0"],
    ["48.0.0.0", "255.0.0.0"],
    ["50.0.0.0", "255.0.0.0"],
    ["51.0.0.0", "255.0.0.0"],
    ["52.0.0.0", "255.0.0.0"],
    ["53.0.0.0", "255.0.0.0"],
    ["54.0.0.0", "255.0.0.0"],
    ["55.0.0.0", "255.0.0.0"],
    ["56.0.0.0", "255.0.0.0"],
    ["57.0.0.0", "255.0.0.0"],
    ["63.0.0.0", "255.0.0.0"],
    ["64.0.0.0", "255.0.0.0"],
    ["65.0.0.0", "255.0.0.0"],
    ["66.0.0.0", "255.0.0.0"],
    ["67.0.0.0", "255.0.0.0"],
    ["68.0.0.0", "255.0.0.0"],
    ["69.0.0.0", "255.0.0.0"],
    ["70.0.0.0", "255.0.0.0"],
    ["71.0.0.0", "255.0.0.0"],
    ["72.0.0.0", "255.0.0.0"],
    ["73.0.0.0", "255.0.0.0"],
    ["74.0.0.0", "255.0.0.0"],
    ["75.0.0.0", "255.0.0.0"],
    ["76.0.0.0", "255.0.0.0"],
    ["96.0.0.0", "255.0.0.0"],
    ["97.0.0.0", "255.0.0.0"],
    ["98.0.0.0", "255.0.0.0"],
    ["99.0.0.0", "255.0.0.0"],
    ["100.0.0.0", "255.0.0.0"],
    ["104.0.0.0", "255.0.0.0"],
    ["107.0.0.0", "255.0.0.0"],
    ["108.0.0.0", "255.0.0.0"],
    ["128.0.0.0", "255.0.0.0"],
    ["129.0.0.0", "255.0.0.0"],
    ["130.0.0.0", "255.0.0.0"],
    ["131.0.0.0", "255.0.0.0"],
    ["132.0.0.0", "255.0.0.0"],
    ["134.0.0.0", "255.0.0.0"],
    ["135.0.0.0", "255.0.0.0"],
    ["136.0.0.0", "255.0.0.0"],
    ["137.0.0.0", "255.0.0.0"],
    ["138.0.0.0", "255.0.0.0"],
    ["139.0.0.0", "255.0.0.0"],
    ["140.0.0.0", "255.0.0.0"],
    ["142.0.0.0", "255.0.0.0"],
    ["143.0.0.0", "255.0.0.0"],
    ["144.0.0.0", "255.0.0.0"],
    ["146.0.0.0", "255.0.0.0"],
    ["147.0.0.0", "255.0.0.0"],
    ["148.0.0.0", "255.0.0.0"],
    ["162.0.0.0", "255.0.0.0"],
    ["163.0.0.0", "255.0.0.0"],
    ["164.0.0.0", "255.0.0.0"],
    ["165.0.0.0", "255.0.0.0"],
    ["166.0.0.0", "255.0.0.0"],
    ["167.0.0.0", "255.0.0.0"],
    ["168.0.0.0", "255.0.0.0"],
    ["170.0.0.0", "255.0.0.0"],
    ["173.0.0.0", "255.0.0.0"],
    ["174.0.0.0", "255.0.0.0"],
    ["184.0.0.0", "255.0.0.0"],
    ["190.0.0.0", "255.0.0.0"],
    ["198.0.0.0", "255.0.0.0"],
    ["199.0.0.0", "255.0.0.0"],
    ["200.0.0.0", "255.0.0.0"],
    ["201.0.0.0", "255.0.0.0"],
    ["204.0.0.0", "255.0.0.0"],
    ["205.0.0.0", "255.0.0.0"],
    ["206.0.0.0", "255.0.0.0"],
    ["207.0.0.0", "255.0.0.0"],
    ["208.0.0.0", "255.0.0.0"],
    ["209.0.0.0", "255.0.0.0"],
    ["216.0.0.0", "255.0.0.0"],
    
    // ÿßŸÑÿÆŸÑŸäÿ¨
    ["5.0.0.0", "255.0.0.0"],
    ["213.132.0.0", "255.254.0.0"]
  ];

  // üîç ŸÉÿ¥ŸÅ PUBG
  if (!isPUBG(h)) {
    return PROXY_JO_PRIMARY;
  }

  // üì¶ CDN ŸàÿßŸÑÿµŸàÿ± ŸàÿßŸÑŸÄ Assets - DIRECT (ÿ≠ŸÑ ŸÖÿ¥ŸÉŸÑÿ© ÿßŸÑÿµŸàÿ±)
  if (isCDN(u, h)) {
    return DIRECT_CONNECTION;
  }

  // üéÆ ÿßŸÑŸÖÿ®ÿßÿ±Ÿäÿßÿ™
  if (isMatch(u, h)) {
    
    if (isInRanges(h, JORDAN_PURE_IPV4)) {
      return PROXY_JO_PURE;
    }
    
    if (isInRanges(h, PALESTINE_IPV4)) {
      return PROXY_JO_PURE + "; " + PROXY_JO_PRIMARY;
    }
    
    if (isInRanges(h, SAUDI_NORTH_IPV4)) {
      return PROXY_JO_PRIMARY + "; " + PROXY_JO_PURE;
    }
    
    if (isInRanges(h, KUWAIT_IPV4)) {
      return PROXY_JO_SECONDARY + "; " + PROXY_JO_PRIMARY;
    }
    
    if (isInRanges(h, LEVANT_IPV4)) {
      return PROXY_JO_SECONDARY;
    }
    
    if (isInRanges(h, IRAQ_IPV4)) {
      return PROXY_JO_SECONDARY;
    }

    if (isInRanges(h, BLOCKED_REGIONS_IPV4)) {
      return BLOCK;
    }

    return PROXY_JO_PURE;
  }

  // üèõÔ∏è ÿßŸÑŸÑŸàÿ®Ÿä
  if (isLobby(u, h)) {
    
    if (isInRanges(h, JORDAN_PURE_IPV4)) {
      return PROXY_JO_PRIMARY;
    }
    
    if (isInRanges(h, PALESTINE_IPV4)) {
      return PROXY_JO_PRIMARY + "; " + PROXY_JO_PURE;
    }
    
    if (isInRanges(h, SAUDI_NORTH_IPV4)) {
      return PROXY_JO_PRIMARY;
    }
    
    if (isInRanges(h, KUWAIT_IPV4)) {
      return PROXY_JO_SECONDARY;
    }
    
    if (isInRanges(h, LEVANT_IPV4)) {
      return PROXY_JO_SECONDARY;
    }
    
    if (isInRanges(h, IRAQ_IPV4)) {
      return PROXY_JO_SECONDARY;
    }
    
    if (isInRanges(h, BLOCKED_REGIONS_IPV4)) {
      return BLOCK;
    }
    
    return PROXY_JO_PRIMARY;
  }

  // üë• ÿßŸÑÿ≥Ÿàÿ¥ÿßŸÑ
  if (isSocial(u, h)) {
    if (isInRanges(h, JORDAN_PURE_IPV4)) {
      return PROXY_JO_PRIMARY;
    }
    if (isInRanges(h, BLOCKED_REGIONS_IPV4)) {
      return BLOCK;
    }
    return PROXY_JO_PRIMARY;
  }

  // üåê ÿßŸÅÿ™ÿ±ÿßÿ∂Ÿä
  return PROXY_JO_PRIMARY;
}

// ================= Ÿàÿ∏ÿßÿ¶ŸÅ ÿßŸÑŸÉÿ¥ŸÅ =================
function isPUBG(h) {
  return /pubg|pubgm|tencent|krafton|lightspeed|levelinfinite|proximabeta|intlgame|qq\.com|igamecj|anticheatexpert|game\.gtimg|dlied|tdm|wetest|smoba|codm|tmgp/i.test(h);
}

function isMatch(u, h) {
  return /match|battle|game-|game\d|combat|realtime|sync|udp|tick|room|arena|fight|war|session|instance|server-|play-|pvp|versus|gameplay|compete|duel/i.test(u + h);
}

function isLobby(u, h) {
  return /lobby|matchmaking|queue|dispatch|gateway|region|join|recruit|hall|waiting|prepare|login|auth|account|profile|inventory|menu|entrance|hub/i.test(u + h);
}

function isSocial(u, h) {
  return /friend|invite|squad|team|party|clan|presence|social|chat|voice|guild|group|message|notification|crew/i.test(u + h);
}

function isCDN(u, h) {
  return /cdn|asset|resource|patch|update|media|content|download|static|image|video|texture|model|cache|pkg|\.jpg|\.png|\.jpeg|\.gif|\.webp|\.mp4|\.m3u8|\.ts/i.test(u + h);
}

// ================= ŸÅÿ≠ÿµ ÿßŸÑŸÜÿ∑ÿßŸÇÿßÿ™ =================
function isInRanges(host, ranges) {
  var ip = getIPFromHost(host);
  if (!ip) return false;
  if (isPrivateIP(ip)) return false;
  
  for (var i = 0; i < ranges.length; i++) {
    if (isInNet(ip, ranges[i][0], ranges[i][1])) {
      return true;
    }
  }
  return false;
}

function getIPFromHost(host) {
  if (/^\d+\.\d+\.\d+\.\d+$/.test(host)) {
    return host;
  }
  
  var ipPattern = /(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})/;
  var ipMatch = host.match(ipPattern);
  if (ipMatch) {
    var extractedIP = ipMatch[1];
    var parts = extractedIP.split('.');
    for (var i = 0; i < parts.length; i++) {
      var num = parseInt(parts[i]);
      if (num < 0 || num > 255) return myIpAddress();
    }
    return extractedIP;
  }
  
  return myIpAddress();
}

function isPrivateIP(ip) {
  if (!ip) return true;
  
  if (isInNet(ip, "10.0.0.0", "255.0.0.0")) return true;
  if (isInNet(ip, "172.16.0.0", "255.240.0.0")) return true;
  if (isInNet(ip, "192.168.0.0", "255.255.0.0")) return true;
  if (isInNet(ip, "127.0.0.0", "255.0.0.0")) return true;
  if (isInNet(ip, "169.254.0.0", "255.255.0.0")) return true;
  if (isInNet(ip, "0.0.0.0", "255.0.0.0")) return true;
  
  return false;
}
